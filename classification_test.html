<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medium to Low Classification Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #000;
            color: #fff;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #333;
        }
        .success { background: #004400; border-color: #00ff00; }
        .info { background: #000044; border-color: #0088ff; }
        .warning { background: #444400; border-color: #ffff00; }
    </style>
</head>
<body>
    <h1>Verification: Medium Devices Now Classified as Low</h1>
    <div id="results"></div>
    
    <script>
        // Simulate different device capabilities to test classification
        const testCases = [
            {
                name: "Ultra-Low End Device",
                hardwareConcurrency: 1,
                deviceMemory: 1,
                userAgent: "Mozilla/5.0 (Android 4.0)",
                expected: "ultra-low"
            },
            {
                name: "Low End Device", 
                hardwareConcurrency: 2,
                deviceMemory: 2,
                userAgent: "Mozilla/5.0 (Android 6.0)",
                expected: "low"
            },
            {
                name: "Low-Medium Device",
                hardwareConcurrency: 4,
                deviceMemory: 3,
                userAgent: "Mozilla/5.0 (Windows NT 10.0)",
                expected: "low-medium"
            },
            {
                name: "Previously Medium Device (now Low)",
                hardwareConcurrency: 6,
                deviceMemory: 6,
                userAgent: "Mozilla/5.0 (Windows NT 10.0)",
                expected: "low"
            },
            {
                name: "High End Device",
                hardwareConcurrency: 8,
                deviceMemory: 8,
                userAgent: "Mozilla/5.0 (Windows NT 10.0)",
                expected: "high"
            },
            {
                name: "Ultra-High End Device",
                hardwareConcurrency: 16,
                deviceMemory: 32,
                userAgent: "Mozilla/5.0 (Windows NT 10.0)",
                expected: "ultra-high"
            }
        ];

        function testDeviceClassification(testCase) {
            // Mock navigator for testing
            const mockNavigator = {
                hardwareConcurrency: testCase.hardwareConcurrency,
                deviceMemory: testCase.deviceMemory,
                userAgent: testCase.userAgent,
                connection: { effectiveType: '4g', downlink: 10, saveData: false }
            };

            // Simulate device classification logic
            const getDeviceMemory = () => mockNavigator.deviceMemory || 1;
            const deviceMemory = getDeviceMemory();

            const ultraLowEndFactors = [
                mockNavigator.hardwareConcurrency < 2,
                deviceMemory < 1.5,
                /Android.*[2-4]\.|iPhone.*OS [4-8]_/.test(mockNavigator.userAgent),
                mockNavigator.connection.effectiveType === 'slow-2g',
                screen.width <= 320 && deviceMemory < 2,
                navigator.maxTouchPoints > 0 && deviceMemory < 1
            ];

            const lowEndFactors = [
                mockNavigator.hardwareConcurrency < 4,
                deviceMemory < 3,
                /Android.*4\.|iPhone.*OS [5-9]_|Windows Phone/.test(mockNavigator.userAgent),
                mockNavigator.connection.effectiveType === '2g',
                mockNavigator.connection.saveData === true,
                screen.width <= 480 && deviceMemory < 2,
                navigator.maxTouchPoints > 0 && deviceMemory < 3
            ];

            const ultraLowScore = ultraLowEndFactors.filter(Boolean).length;
            const lowScore = lowEndFactors.filter(Boolean).length;

            let performanceLevel;
            
            if (ultraLowScore >= 2) {
                performanceLevel = "ultra-low";
            } else if (lowScore >= 3) {
                performanceLevel = "low";
            } else if (lowScore >= 1 || ultraLowScore >= 1) {
                performanceLevel = "low-medium";
            } else {
                // High-end classification - Simplified without medium level
                if (
                    mockNavigator.hardwareConcurrency >= 12 &&
                    deviceMemory >= 16 &&
                    mockNavigator.connection.downlink > 10
                ) {
                    performanceLevel = "ultra-high";
                } else if (
                    mockNavigator.hardwareConcurrency >= 8 &&
                    deviceMemory >= 8
                ) {
                    performanceLevel = "high";
                } else {
                    // Previously medium devices are now classified as low for more aggressive optimization
                    performanceLevel = "low";
                }
            }

            return {
                actual: performanceLevel,
                expected: testCase.expected,
                passed: performanceLevel === testCase.expected,
                details: {
                    cores: mockNavigator.hardwareConcurrency,
                    memory: deviceMemory,
                    ultraLowScore,
                    lowScore
                }
            };
        }

        // Run tests and display results
        const resultsDiv = document.getElementById('results');
        
        testCases.forEach(testCase => {
            const result = testDeviceClassification(testCase);
            const div = document.createElement('div');
            
            div.className = `test-result ${result.passed ? 'success' : 'warning'}`;
            div.innerHTML = `
                <h3>${testCase.name}</h3>
                <p><strong>Expected:</strong> ${result.expected}</p>
                <p><strong>Actual:</strong> ${result.actual}</p>
                <p><strong>Status:</strong> ${result.passed ? '✅ PASSED' : '⚠️ UNEXPECTED'}</p>
                <p><strong>Details:</strong> Cores: ${result.details.cores}, Memory: ${result.details.memory}GB, Ultra-Low Score: ${result.details.ultraLowScore}, Low Score: ${result.details.lowScore}</p>
            `;
            
            resultsDiv.appendChild(div);
        });

        // Add summary
        const passedTests = testCases.filter(tc => testDeviceClassification(tc).passed).length;
        const summaryDiv = document.createElement('div');
        summaryDiv.className = `test-result ${passedTests === testCases.length ? 'success' : 'warning'}`;
        summaryDiv.innerHTML = `
            <h3>Summary</h3>
            <p><strong>Tests Passed:</strong> ${passedTests}/${testCases.length}</p>
            <p><strong>Key Change:</strong> Devices that previously would be classified as "medium" are now classified as "low" for more aggressive optimization.</p>
            <p><strong>Performance Levels:</strong> ultra-low, low, low-medium, high, ultra-high (medium removed)</p>
        `;
        resultsDiv.appendChild(summaryDiv);
    </script>
</body>
</html>